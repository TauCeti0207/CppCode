<div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-163de54645.css">
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p>
<div class="toc">
 <h3><a name="t0"></a>文章目录</h3>
 <ul><li><a href="#_2" target="_self">一、前言</a></li><li><a href="#_7" target="_self">二、哈希表</a></li><li><ul><li><a href="#1_8" target="_self">1、哈希表概念</a></li><li><ul><li><a href="#1_13" target="_self">1）哈希数组</a></li><li><a href="#2_17" target="_self">2）关键字</a></li><li><a href="#3_29" target="_self">3）哈希函数</a></li><li><a href="#4_41" target="_self">4）值</a></li></ul>
   </li><li><a href="#2_45" target="_self">2、简单下标哈希</a></li><li><a href="#3_87" target="_self">3、散列哈希</a></li><li><ul><li><a href="#1_92" target="_self">1）哈希值离散</a></li><li><a href="#2_96" target="_self">2）除留余数法</a></li><li><a href="#3_101" target="_self">3）哈希冲突</a></li><li><a href="#4_119" target="_self">4）负载因子</a></li><li><a href="#5rehash_124" target="_self">5）rehash</a></li><li><a href="#6_128" target="_self">6）取模位运算优化</a></li></ul>
   </li><li><a href="#4_133" target="_self">4、散列哈希的实现</a></li><li><a href="#5_186" target="_self">5、字符串哈希</a></li><li><ul><li><a href="#1B__191" target="_self">1）B 进制</a></li><li><a href="#2_200" target="_self">2）取模</a></li><li><a href="#3_205" target="_self">3）自然溢出</a></li><li><a href="#4_209" target="_self">4）双哈希</a></li><li><a href="#5_214" target="_self">5）子串哈希值</a></li></ul>
  </li></ul>
  </li><li><a href="#_231" target="_self">三、哈希表的应用</a></li><li><ul><li><a href="#1_232" target="_self">1、代替排序</a></li><li><a href="#2_238" target="_self">2、多元方程的整数解数</a></li><li><a href="#3_250" target="_self">3、状态哈希</a></li><li><ul><li><a href="#1_253" target="_self">1）动态规划的状态哈希</a></li><li><a href="#2_266" target="_self">2）广度优先搜索的状态哈希</a></li></ul>
   </li><li><a href="#4_280" target="_self">4、最长回文串</a></li><li><a href="#5_300" target="_self">5、最长公共子串</a></li></ul>
  </li><li><a href="#_314" target="_self">四、哈希题集整理</a></li></ul>
</div>
<p></p> 
<h1><a name="t1"></a><a id="_2"></a>一、前言</h1> 
<blockquote> 
 <p>  目前本专栏正在进行优惠活动，在博主主页添加博主好友，可以获取 <font color="red"><strong>付费专栏优惠券</strong></font>。<br>   谈起<a href="https://so.csdn.net/so/search?q=%E5%93%88%E5%B8%8C&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E5%93%88%E5%B8%8C&amp;spm=1001.2101.3001.7020&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E5%93%88%E5%B8%8C&amp;spm=1001.2101.3001.7020&quot;}" data-tit="哈希" data-pretit="哈希">哈希</a>表，学过数据结构的同学，应该都已经耳熟能详了，因为太基础所以一直没有单独拿出来讲，然而 广度优先搜索 和 动态规划 里面都涉及到了状态哈希，所以还是有必要拿出来讲一下的。所谓的 状态 到底是一个什么概念，为什么要对状态进行 哈希。希望读者看完本章内容，能够有一个大概的概念，能对后续要讲到的 广度优先搜索 以及 状态压缩动态规划 起到一定的铺垫作用。<br>  虽然，我曾经一度认为自己对哈希表的理解已经很透彻了，但是今天我在总结这篇文章的时候，突然领悟了几个之前比较模糊的概念，而且就在那一瞬间，犹如醍醐灌顶，茅塞顿开，这种感觉实在是太棒了！<img src="https://img-blog.csdnimg.cn/20210703122654382.gif#pic_center" alt=""></p> 
</blockquote> 
<h1><a name="t2"></a><a id="_7"></a>二、哈希表</h1> 
<h2><a name="t3"></a><a id="1_8"></a>1、哈希表概念</h2> 
<ul><li>哈希表（Hash table）的初衷是为了将关键字值 (key - value) 映射到数组中的某个位置，这样就能够通过数组下标访问该数据，省去了遍历整个数据结构的过程，从而提高了数据的查找速度，查找的平均期望时间复杂度是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         1
        
        
         )
        
       
       
        O(1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 的。</li><li>redis 中的<strong>键值对</strong>、python 中的 <strong>dict</strong> 、lua 中的 <strong>table</strong>、C++ STL 中的 <strong>unordered_map</strong> 等等，底层都是采用哈希表来实现的，可见哈希表在实际应用中还是很广泛的。</li><li>首先，介绍几个概念来对哈希表有一个初步的认识。</li></ul> 
<h3><a name="t4"></a><a id="1_13"></a>1）哈希数组</h3> 
<ul><li>为了方便下标索引，哈希表的底层实现结构是一个数组，数组类型可以是任意类型，每个位置被称为一个槽（slot）。如图二-1-1所示，它代表的是一个长度为 8 的哈希数组。</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210120064654913.png#pic_center" alt=""></p>
<center>
 图二-1-1
</center>
<p></p> 
<h3><a name="t5"></a><a id="2_17"></a>2）关键字</h3> 
<ul><li>关键字（key）是任意类型，可以是整型、长整型、字符串甚至是结构体或者类；如下的 a、b、o 都可以是关键字；</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
string b <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Obj</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Obj o<span class="token punctuation">;</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li></ul></pre> 
<ul><li>哈希表的实现过程中，我们需要通过一些手段，将一个非整型的关键字转换成整型，然后再对哈希数组的长度进行取模，转换为下标，从而找到它所对应的位置，实现快速关键字查找。如图二-1-2所示：<br> <img src="https://img-blog.csdnimg.cn/202101200746078.png#pic_center" alt="">
  <center>
   图二-1-2
  </center></li><li>而将一个非整型的关键字转换成整型的手段就是 哈希函数。</li></ul> 
<h3><a name="t6"></a><a id="3_29"></a>3）哈希函数</h3> 
<ul><li>哈希函数可以简单的理解为就是小学课本上那个函数，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         y
        
        
         =
        
        
         f
        
        
         (
        
        
         x
        
        
         )
        
       
       
        y = f(x)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span>，这里的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         f
        
        
         (
        
        
         x
        
        
         )
        
       
       
        f(x)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> 就是哈希函数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 是关键字，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         y
        
       
       
        y
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 是值。好的哈希函数应该具备以下两个特质：</li><li>1）单射（或者叫 一一映射）；</li><li>2）雪崩效应：输入值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         x
        
        
         )
        
       
       
        (x)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> 的 1 位的变化，能够造成输出值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         y
        
        
         )
        
       
       
        (y)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> 1/2 的位的变化；</li><li>单射很容易理解，如图二-1-3所示。图 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         a
        
        
         )
        
       
       
        (a)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></span> 中已知哈希值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         y
        
       
       
        y
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 时，键 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 可能有两种情况，不是一个单射；而图 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         b
        
        
         )
        
       
       
        (b)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span> 中已知哈希值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         y
        
       
       
        y
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 时，键 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 一定是唯一确定的，所以它是单射。由于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         y
        
       
       
        y
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 一一对应，所以在没有取模之前，至少是没有冲突的，这样就从本原上减少了冲突。</li><li>雪崩效应是为了让哈希值更加符合随机分布的原则，哈希表中的键分布的越随机，利用率越高，效率也越高。<br> <img src="https://img-blog.csdnimg.cn/img_convert/1ea359360a97c0deff40a5e4d483e6a9.png#pic_center" alt="">
  <center>
   图二-1-3
  </center></li><li>整数的哈希函数比较简单，可以为自身：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          x
         
         
          )
         
         
          =
         
         
          x
         
        
        
         hash(x) = x
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span></span></li><li>字符串的哈希函数设计的时候，一般是遍历整个字符串进行某种运算，最后得到的是一个长整型；<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          )
         
         
          =
         
         
          9456043234891890
         
         
          l
         
         
          l
         
        
        
         hash(s) = 9456043234891890ll
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">9</span><span class="mord">4</span><span class="mord">5</span><span class="mord">6</span><span class="mord">0</span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span><span class="mord">3</span><span class="mord">4</span><span class="mord">8</span><span class="mord">9</span><span class="mord">1</span><span class="mord">8</span><span class="mord">9</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></li><li>类的哈希函数，设计的时候可以先实现一个 <code>toString</code>接转化成字符串，然后再对这个字符串进行字符串哈希；</li></ul> 
<h3><a name="t7"></a><a id="4_41"></a>4）值</h3> 
<ul><li>这里的值 （value），就对应了上文提到的哈希数组的类型；</li><li>整个哈希过程就是通过 关键字 (key) 找 值 (value) 的过程。</li></ul> 
<h2><a name="t8"></a><a id="2_45"></a>2、简单下标哈希</h2> 
<ul><li>简单下标哈希就是利用关键字直接访问数组元素，省去了计算哈希值、取模、以及寻址的过程，如图二-2-1所示：</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/img_convert/2c3773e6387e7f8b2846826c9517cb1d.png#pic_center" alt=""></p>
<center>
 图二-2-1
</center>
<p></p> 
<ul><li>查找时间复杂度 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         1
        
        
         )
        
       
       
        O(1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 。但是对关键字要求较高，首先必须是整数，其次是关键字的范围必须严格控制在哈希数组范围内。</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210119191514222.png#pic_center" alt=""></p>
<center>
 图二-2-2
</center>
<p></p> 
<ul><li>上图中，圆形代表了关键字，方形格子则代表了哈希数组，箭头表示下标访问。</li><li>例如：一共 4 个人，编号为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         1
        
        
         ,
        
        
         3
        
        
         ,
        
        
         4
        
        
         ,
        
        
         6
        
        
         )
        
       
       
        (1, 3, 4, 6)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">6</span><span class="mclose">)</span></span></span></span></span>，现在要存储每个人的年龄，那么用一个数组<code>int age[8]</code>就可以存储了。访问的时候直接通过下标就能 获取/设置 对应编号的人的年龄，这个存取的过程就是最简单的下标哈希了。</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">int</span> age<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
age<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> age<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li></ul></pre> 
<ul><li>这种简单下标哈希在之前的章节已经有大量的应用，比如：</li><li>1）并查集：对每个元素映射到对应集合的时候采用的就是下标哈希，<code>fset[i] = i;</code>代表 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span> 这个元素所属的集合编号；</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">const</span> <span class="token keyword">int</span> MAXN <span class="token operator">=</span> <span class="token number">300010</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> fset<span class="token punctuation">[</span>MAXN<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        fset<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li></ul></pre> 
<ul><li>2）字典树：在对子结点<code>nodes_[]</code>进行存储的时候，字母减去了一个偏移量后映射到数组中，采用的也是下标哈希；</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">const</span> <span class="token keyword">int</span> TRIE_NODE_COUNT <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">TrieNode</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> nodes_<span class="token punctuation">[</span>TRIE_NODE_COUNT<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li></ul></pre> 
<ul><li>3）二分图：在染色算法中，每个结点的颜色存储到<code>color_[]</code>数组时，用到的也是简单下标哈希；</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;">    <span class="token keyword">if</span> <span class="token punctuation">(</span>color_<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        color_<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> color_<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
        Q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li></ul></pre> 
<h2><a name="t9"></a><a id="3_87"></a>3、散列哈希</h2> 
<ul><li>接下来，我们来介绍一下更加一般的情况，即通过一个不在数组范围内的整型（或长整型），通过计算得到它的值。如图二-3-1所示：</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210120075618291.png#pic_center" alt=""></p>
<center>
 图二-3-1
</center>
<p></p> 
<h3><a name="t10"></a><a id="1_92"></a>1）哈希值离散</h3> 
<ul><li>实际问题中，我们的数组可能没有那么大，或者哈希值比较离散，离散的反义词是连续，例如：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         1
        
        
         、
        
        
         3
        
        
         、
        
        
         4
        
        
         、
        
        
         6
        
        
         )
        
       
       
        (1、3、4、6)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord cjk_fallback">、</span><span class="mord">3</span><span class="mord cjk_fallback">、</span><span class="mord">4</span><span class="mord cjk_fallback">、</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></span> 相对于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         1
        
        
         、
        
        
         2
        
        
         、
        
        
         3
        
        
         、
        
        
         4
        
        
         )
        
       
       
        (1、2、3、4)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord cjk_fallback">、</span><span class="mord">2</span><span class="mord cjk_fallback">、</span><span class="mord">3</span><span class="mord cjk_fallback">、</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span> 就是离散的。如图二-3-2所示：<br> <img src="https://img-blog.csdnimg.cn/20210119195104487.png#pic_center" alt="">
  <center>
   图二-3-2
  </center></li><li>数组的长度只有 4，但是我们的哈希值分别为 1、3、4、6，无法采用下标进行映射；</li></ul> 
<h3><a name="t11"></a><a id="2_96"></a>2）除留余数法</h3> 
<ul><li>由于数组长度为 4，所以我们可以将哈希值 模 4 再进行映射，如图二-3-3所示：<br> <img src="https://img-blog.csdnimg.cn/20210119200007902.png#pic_center" alt="">
  <center>
   图二-3-3
  </center></li><li>比如用 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
       
       
        x
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> 代表哈希值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         f
        
        
         (
        
        
         x
        
        
         )
        
       
       
        f(x)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> 代表实际映射的下标，则有如下公式：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          f
         
         
          (
         
         
          x
         
         
          )
         
         
          =
         
         
          x
         
         
          &nbsp;
         
         
          m
         
         
          o
         
         
          d
         
         
          &nbsp;
         
         
          4
         
        
        
         f(x) = x \ mod \ 4
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">&nbsp;</span><span class="mord">4</span></span></span></span></span></span></li><li>这样做虽然解决了哈希值离散的问题，同时也带来了另一个问题，那就是 哈希冲突。</li></ul> 
<h3><a name="t12"></a><a id="3_101"></a>3）哈希冲突</h3> 
<ul><li>所谓哈希冲突，就是两个不同的哈希值通过取模映射到了同一个下标。这样就会产生二义性，如图二-3-4 所示：</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210119220307667.png#pic_center" alt=""></p>
<center>
 图二-3-4
</center>
<p></p> 
<ul><li>图中 1 和 9 模 4 的余数都为 1，所以都映射到了下标为 1 的位置，这样取的时候就无法知道原哈希值到底是 1 还是 9 了。于是，就需要有一些应对哈希冲突的解决方案，常用的有：链地址法、开放寻址法、再散列法。</li></ul> 
<p><strong>a. 链地址法</strong></p> 
<ul><li>数组存储值数据的链表头，将所有取模后一样的哈希值用链表串起来，查找的时候先取模找到对应下标位置，然后在对应链表上遍历找到对应哈希值的数据。如图二-3-5所示：</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210119222235125.png#pic_center" alt=""></p>
<center>
 图二-3-5
</center>
<p></p> 
<ul><li>这种方法对哈希值要求比较高，必须尽量平均分布。考虑一种极端情况：所有哈希值都模 4 同余，那么它们会映射到同一个下标，导致最后的结构退化成了链表，查找效率退化为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         n
        
        
         )
        
       
       
        O(n)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span>。</li></ul> 
<p><strong>b. 开放寻址法</strong></p> 
<ul><li>数组存储值数据，如果遇到取模后发现已经有数据，则往数组后移一位，如果还有继续移动，直到找到一个空闲位置，如图二-3-6所示：<br> <img src="https://img-blog.csdnimg.cn/20210119223838279.png#pic_center" alt="">
  <center>
   图二-3-6
  </center></li><li>哈希值 9 对 4 取模以后值为 1，但是发现下标为 1 的位置上已经有元素了，于是往后继续找一个，找到下标为 2 的位置，于是产生映射 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         f
        
        
         (
        
        
         9
        
        
         )
        
        
         =
        
        
         2
        
       
       
        f(9) = 2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">9</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span>。</li><li>这种方法对不同的哈希值的个数要求有限制，必须小于等于哈希数组大小，否则永远找不到就会产生死循环。而且随着哈希值增多，插入和查找效率下降。</li></ul> 
<h3><a name="t13"></a><a id="4_119"></a>4）负载因子</h3> 
<ul><li>无论是链地址法还是开放地址法都会遇到一个问题，就是一旦数据量上去以后，都会导致查找效率下降，于是，这里引入一个负载因子的概念：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          负
         
         
          载
         
         
          因
         
         
          子
         
         
          =
         
         
          哈
         
         
          希
         
         
          值
         
         
          个
         
         
          数
         
         
          /
         
         
          数
         
         
          组
         
         
          长
         
         
          度
         
        
        
         负载因子 = 哈希值个数 / 数组长度
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mord cjk_fallback">负</span><span class="mord cjk_fallback">载</span><span class="mord cjk_fallback">因</span><span class="mord cjk_fallback">子</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord cjk_fallback">哈</span><span class="mord cjk_fallback">希</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord">/</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">组</span><span class="mord cjk_fallback">长</span><span class="mord cjk_fallback">度</span></span></span></span></span></span></li><li>对于链地址法来说，负载因子 &gt; 5 就要考虑 rehash 了；而对于开放寻址法，负载因子 &gt; 0.7 时，考虑 rehash，那么什么是 rehash 呢？</li></ul> 
<h3><a name="t14"></a><a id="5rehash_124"></a>5）rehash</h3> 
<ul><li>所谓 rehash，就是申请一块新的空间，空间的大小为原哈希数组的两倍，然后把原有的数据全部取出来映射到新的哈希数组里，再释放原有哈希数组。</li><li>实际实现的时候，为了减少申请空间带来的开销，一般是预先就一直有两个哈希数组（指针），然后采用滚动的方式进行扩容，扩容完毕交换指针。</li><li>并且由于一次 rehash 的耗时可能较长，一般采用渐进式 rehash，分散 CPU 的执行时间，具体细节可以参考 redis 源码的实现，这里不再展开来说了。</li></ul> 
<h3><a name="t15"></a><a id="6_128"></a>6）取模位运算优化</h3> 
<ul><li>哈希数组的长度一般选择 2 的幂，因为我们知道取模运算是比较耗时的，而位运算相对较为高效；</li><li>选择 2 的幂作为数组长度，可以将 取模运算 转换成 二进制位与(&amp;)；</li><li>令 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
        
         =
        
        
         
          2
         
         
          k
         
        
       
       
        S = 2^k
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span>，那么它的二进制表示就是：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
        
         =
        
        
         (
        
        
         1
        
        
         
          
           000...000
          
          
           ⏟
          
         
         
          k
         
        
        
         
          )
         
         
          2
         
        
       
       
        S = (1\underbrace{000...000}_{\rm k})_2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.08411em; vertical-align: -1.33411em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.64444em;"><span class="" style="top: -1.66589em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">k</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.64444em;"><span class="svg-align" style="top: -2.352em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                   <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                  </svg></span><span class="brace-center" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                   <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                  </svg></span><span class="brace-right" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                   <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                  </svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.648em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.33411em;"><span class=""></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，任何一个数模上 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
       
       
        S
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span></span></span>，就相当于取了 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
       
       
        S
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span></span></span> 的二进制低 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
       
       
        k
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span> 位，而 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
        
         −
        
        
         1
        
        
         =
        
        
         (
        
        
         
          
           111...111
          
          
           ⏟
          
         
         
          k
         
        
        
         
          )
         
         
          2
         
        
       
       
        S-1 = (\underbrace{111...111}_{\rm k})_2
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.08411em; vertical-align: -1.33411em;"></span><span class="mopen">(</span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.64444em;"><span class="" style="top: -1.66589em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">k</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.64444em;"><span class="svg-align" style="top: -2.352em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                   <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                  </svg></span><span class="brace-center" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                   <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                  </svg></span><span class="brace-right" style="height: 0.548em;">
                  <svg width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                   <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                  </svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">1</span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">1</span><span class="mord">1</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.648em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.33411em;"><span class=""></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ，所以和 位与 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         S
        
        
         −
        
        
         1
        
       
       
        S-1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 的效果是一样的。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          x
         
         
          &nbsp;
         
         
          %
         
         
          &nbsp;
         
         
          S
         
         
          =
         
         
          =
         
         
          x
         
         
          &nbsp;
         
         
          &amp;
         
         
          &nbsp;
         
         
          (
         
         
          S
         
         
          −
         
         
          1
         
         
          )
         
         
          ;
         
        
        
         x \ \% \ S == x \ \&amp; \ (S - 1);
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.80556em; vertical-align: -0.05556em;"></span><span class="mord mathdefault">x</span><span class="mspace">&nbsp;</span><span class="mord">%</span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">x</span><span class="mspace">&nbsp;</span><span class="mord">&amp;</span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">;</span></span></span></span></span></span></li></ul> 
<h2><a name="t16"></a><a id="4_133"></a>4、散列哈希的实现</h2> 
<ul><li>这里介绍一种简单的哈希再散列的实现，为了尽量简化代码，假设了几个问题：</li><li><strong>1）不涉及 rehash</strong>：因为哈希数组长度足够大，元素个数可控；</li><li><strong>2）不考虑负载因子</strong>：因为不进行 rehash ，自然也不用考虑负载因子了；</li><li><strong>3）采用开放寻址法</strong>：不用链地址法，避免申请堆内存的开销；</li><li>先给出代码，再进行讲解：</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HashValueType</span> <span class="token expression"><span class="token keyword">long</span> <span class="token keyword">long</span> </span></span>
<span class="token keyword">const</span> <span class="token keyword">int</span> MAXH <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> hashkey<span class="token punctuation">[</span>MAXH<span class="token punctuation">]</span><span class="token punctuation">;</span>                        <span class="token comment">// 1）</span>
HashValueType hashval<span class="token punctuation">[</span>MAXH<span class="token punctuation">]</span><span class="token punctuation">;</span>               

<span class="token keyword">int</span> <span class="token function">getKey</span><span class="token punctuation">(</span>HashValueType val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> key <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">&amp;</span> <span class="token punctuation">(</span>MAXH<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 2）</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hashkey<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>               <span class="token comment">// 3）</span>
            hashkey<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            hashval<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token keyword">return</span> key<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hashval<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> key<span class="token punctuation">;</span>               <span class="token comment">// 4）</span>
            <span class="token punctuation">}</span>
            key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>MAXH <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5）</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li></ul></pre> 
<ul><li>这个函数实现的是：通过给定的哈希值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         v
        
        
         a
        
        
         l
        
       
       
        val
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span>，找到哈希表中哈希值对应的下标索引 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span>，如果找不到则进行插入；</li><li>1）<code>bool hashkey[key]</code>表示映射后 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 这个下标位置是否有元素，<code>HashValueType hashval[key]</code>表示下标为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 这个位置的元素的值，可以是任意类型，<code>HashValueType</code>是一个宏定义，代表哈希数组值的类型。</li><li>2）除留余数法对传进来的元素进行一次取模，并且采用 位与 代替，利用位运算加速；</li><li>3）如果对应的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 在这个位置没有出现过，则代表找到了一个合法位置，则 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 的槽位留给 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         v
        
        
         a
        
        
         l
        
       
       
        val
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span>；</li><li>4）如果对应的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 的槽位正好和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         v
        
        
         a
        
        
         l
        
       
       
        val
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span> 匹配，则说明哈希表已经存在过 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         v
        
        
         a
        
        
         l
        
       
       
        val
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span> 这个元素，返回 key；</li><li>5）没有找到合适的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
        
         e
        
        
         y
        
       
       
        key
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span> 位置， 进行二次寻址；</li><li>那么，我们可以根据类似的方法实现一个只查找不插入的方法，实现如下：</li></ul> 
<pre class="prettyprint"><code class="prism language-cpp has-numbering" onclick="mdcp.copyCode(event)" style="position: unset;"><span class="token keyword">bool</span> <span class="token function">hasKey</span><span class="token punctuation">(</span>HashValueType val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> key <span class="token operator">=</span> <span class="token punctuation">(</span> val <span class="token operator">&amp;</span> <span class="token punctuation">(</span>MAXH<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hashkey<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hashval<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>MAXH <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="hljs-button {2}" data-title="复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li></ul></pre> 
<h2><a name="t17"></a><a id="5_186"></a>5、字符串哈希</h2> 
<ul><li>最后，我们来了解下对于字符串类型的关键字，如何计算哈希值，也就是如图二-5-1所示的这一步。</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/20210120080824463.png#pic_center" alt=""></p>
<center>
 图二-5-1
</center>
<p></p> 
<h3><a name="t18"></a><a id="1B__191"></a>1）B 进制</h3> 
<ul><li>对于一个字符串：“1314”，我们可以认为它是一个十进制数，那么转化成十进制整数就是：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          1
         
         
          ×
         
         
          1
         
         
          
           0
          
          
           3
          
         
         
          +
         
         
          3
         
         
          ×
         
         
          1
         
         
          
           0
          
          
           2
          
         
         
          +
         
         
          1
         
         
          ×
         
         
          1
         
         
          
           0
          
          
           1
          
         
         
          +
         
         
          4
         
         
          ×
         
         
          1
         
         
          
           0
          
          
           0
          
         
         
          =
         
         
          1314
         
        
        
         1 \times 10^3 + 3 \times 10^2 + 1 \times 10^1 + 4 \times 10^0 = 1314
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord">1</span><span class="mord">4</span></span></span></span></span></span></li><li>也可以认为它是个 8 进制数，那么转化成十进制就是：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          1
         
         
          ×
         
         
          
           8
          
          
           3
          
         
         
          +
         
         
          3
         
         
          ×
         
         
          
           8
          
          
           2
          
         
         
          +
         
         
          1
         
         
          ×
         
         
          
           8
          
          
           1
          
         
         
          +
         
         
          4
         
         
          ×
         
         
          
           8
          
          
           0
          
         
         
          =
         
         
          716
         
        
        
         1 \times 8^3 + 3 \times 8^2 + 1 \times 8^1 + 4 \times 8^0 = 716
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">7</span><span class="mord">1</span><span class="mord">6</span></span></span></span></span></span></li><li>同样，也可以认为它是个 16 进制数，那么转化成十进制就是：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          1
         
         
          ×
         
         
          1
         
         
          
           6
          
          
           3
          
         
         
          +
         
         
          3
         
         
          ×
         
         
          1
         
         
          
           6
          
          
           2
          
         
         
          +
         
         
          1
         
         
          ×
         
         
          1
         
         
          
           6
          
          
           1
          
         
         
          +
         
         
          4
         
         
          ×
         
         
          1
         
         
          
           6
          
          
           0
          
         
         
          =
         
         
          4884
         
        
        
         1 \times 16^3 + 3 \times 16^2 + 1 \times 16^1 + 4 \times 16^0 = 4884
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mord">8</span><span class="mord">4</span></span></span></span></span></span></li><li>更加一般的，所有大于 4 的进制都是可以唯一表示这个字符串的；</li><li>对于任意一个字符串，其实都是由 ASCII 字符组成，而每个字符都用 1 个字节表示，即它的范围是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         0
        
        
         ,
        
        
         255
        
        
         ]
        
       
       
        [0, 255]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mclose">]</span></span></span></span></span>，所以我们可以用大于 255 的数来代替进制 B，即任意一个长度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         k
        
       
       
        k
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span> 的字符串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
       
       
        s
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> 可以表示为唯一的整数如下（其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
        
         [
        
        
         i
        
        
         ]
        
       
       
        s[i]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> 代表第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span> 个字符的 ASCII 码值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span> 下标从 1 开始）：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          )
         
         
          =
         
         
          s
         
         
          [
         
         
          1
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           
            k
           
           
            −
           
           
            1
           
          
         
         
          +
         
         
          s
         
         
          [
         
         
          2
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           
            k
           
           
            −
           
           
            2
           
          
         
         
          +
         
         
          …
         
         
          +
         
         
          s
         
         
          [
         
         
          k
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           0
          
         
         
         
          (
         
         
          B
         
         
          ≥
         
         
          256
         
         
          )
         
        
        
         hash(s) = s[1] \times B^{k-1} + s[2] \times B^{k-2} + … + s[k] \times B^{0} \\ (B \ge 256)
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.982438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.982438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></span></span></li></ul> 
<h3><a name="t19"></a><a id="2_200"></a>2）取模</h3> 
<ul><li>随着字符串长度不断变大，算出来的哈希值会越来越大，从而产生溢出，所以一般采取模上一个较大的素数的形式，如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          )
         
         
          =
         
         
          (
         
         
          s
         
         
          [
         
         
          1
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           
            k
           
           
            −
           
           
            1
           
          
         
         
          +
         
         
          s
         
         
          [
         
         
          2
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           
            k
           
           
            −
           
           
            2
           
          
         
         
          +
         
         
          …
         
         
          +
         
         
          s
         
         
          [
         
         
          k
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           0
          
         
         
          )
         
         
          &nbsp;
         
         
          m
         
         
          o
         
         
          d
         
         
          &nbsp;
         
         
          P
         
        
        
         hash(s) = ( s[1] \times B^{k-1} + s[2] \times B^{k-2} + … + s[k] \times B^{0} ) \ mod \ P
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.982438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.982438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></span></li><li>这样做仍然能够保证相同的字符串计算得到的哈希值是一样的，但是却无法保证不相同的字符串计算的哈希值不同，所以为了尽量不让不同的字符串映射到相同的整数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         P
        
       
       
        P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span> 的取值很关键，一般采取较大的素数的形式，进一步的，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         B
        
       
       
        B
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span></span></span></span></span> 也选择一个和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         P
        
       
       
        P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span> 互素的素数更佳；</li></ul> 
<h3><a name="t20"></a><a id="3_205"></a>3）自然溢出</h3> 
<ul><li>根据补码的性质， C++ 中如果定义 <strong>unsigned long long</strong>，溢出的部分等同于对 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         P
        
        
         =
        
        
         
          2
         
         
          64
         
        
       
       
        P = 2^{64}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span> 取模，这样就可以无视取模，任其自然溢出了。</li><li>自然溢出有利有弊：好处就是效率会高出不少，而且能够表示的范围已经是长整型能够表示的最大范围，很大程度上减少哈希冲突；坏处就是取模效果没有素数来的好，对于一些特殊构造的数据，容易造成不相同的字符串计算出相同的哈希值的情况；</li></ul> 
<h3><a name="t21"></a><a id="4_209"></a>4）双哈希</h3> 
<ul><li>当有大量字符串时，这种冲突会被放大，我们可以通过取两对 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         
          B
         
         
          0
         
        
        
         ,
        
        
         
          P
         
         
          0
         
        
        
         )
        
        
         ,
        
        
         (
        
        
         
          B
         
         
          1
         
        
        
         ,
        
        
         
          P
         
         
          1
         
        
        
         )
        
       
       
        (B_0, P_0), (B_1, P_1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的值，进行双哈希，然后取两次哈希的值组成一个新的哈希值，从而大大减少冲突的概率。</li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          0
         
         
          ,
         
         
          s
         
         
          )
         
         
          =
         
         
          (
         
         
          s
         
         
          [
         
         
          1
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           0
          
          
           
            k
           
           
            −
           
           
            1
           
          
         
         
          +
         
         
          s
         
         
          [
         
         
          2
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           0
          
          
           
            k
           
           
            −
           
           
            2
           
          
         
         
          +
         
         
          …
         
         
          +
         
         
          s
         
         
          [
         
         
          k
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           0
          
          
           0
          
         
         
          )
         
         
          &nbsp;
         
         
          m
         
         
          o
         
         
          d
         
         
          &nbsp;
         
         
          
           P
          
          
           0
          
         
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          1
         
         
          ,
         
         
          s
         
         
          )
         
         
          =
         
         
          (
         
         
          s
         
         
          [
         
         
          1
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           1
          
          
           
            k
           
           
            −
           
           
            1
           
          
         
         
          +
         
         
          s
         
         
          [
         
         
          2
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           1
          
          
           
            k
           
           
            −
           
           
            2
           
          
         
         
          +
         
         
          …
         
         
          +
         
         
          s
         
         
          [
         
         
          k
         
         
          ]
         
         
          ×
         
         
          
           B
          
          
           1
          
          
           0
          
         
         
          )
         
         
          &nbsp;
         
         
          m
         
         
          o
         
         
          d
         
         
          &nbsp;
         
         
          
           P
          
          
           1
          
         
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          )
         
         
          =
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          0
         
         
          ,
         
         
          s
         
         
          )
         
         
          ∗
         
         
          m
         
         
          a
         
         
          x
         
         
          (
         
         
          
           P
          
          
           0
          
         
         
          ,
         
         
          
           P
          
          
           1
          
         
         
          )
         
         
          +
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          1
         
         
          ,
         
         
          s
         
         
          )
         
        
        
         hash(0, s) = ( s[1] \times B_0^{k-1} + s[2] \times B_0^{k-2} + … + s[k] \times B_0^{0} ) \ mod \ P_0 \\ hash(1, s) = ( s[1] \times B_1^{k-1} + s[2] \times B_1^{k-2} + … + s[k] \times B_1^{0} ) \ mod \ P_1 \\ hash(s) = hash(0, s) * max(P_0, P_1)+ hash(1, s) 
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.15555em; vertical-align: -0.256439em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.44356em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.256439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.15555em; vertical-align: -0.256439em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.44356em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.256439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -2.453em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.15555em; vertical-align: -0.256439em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.44356em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.256439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.15555em; vertical-align: -0.256439em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -2.44356em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.256439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -2.453em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span></span></li><li>得到的哈希值再进行散列哈希映射到下标即可。</li></ul> 
<h3><a name="t22"></a><a id="5_214"></a>5）子串哈希值</h3> 
<ul><li>对于一个字符串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
       
       
        s
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span>， <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
        
         [
        
        
         l
        
        
         :
        
        
         r
        
        
         ]
        
       
       
        s[l:r]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">]</span></span></span></span></span> 代表 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         s
        
       
       
        s
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> 从 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         l
        
       
       
        l
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span> 到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         r
        
       
       
        r
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span></span></span></span></span> 的子串；</li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         1
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[1:1]) = ( s[1]*B^{0} ) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         2
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          1
         
        
        
         +
        
        
         s
        
        
         [
        
        
         2
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[1:2]) = ( s[1]*B^{1} + s[2]*B^{0} ) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         3
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          2
         
        
        
         +
        
        
         s
        
        
         [
        
        
         2
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          1
         
        
        
         +
        
        
         s
        
        
         [
        
        
         3
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[1:3]) = ( s[1]*B^{2} + s[2]*B^{1} + s[3]*B^{0}) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">3</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         4
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          3
         
        
        
         +
        
        
         s
        
        
         [
        
        
         2
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          2
         
        
        
         +
        
        
         s
        
        
         [
        
        
         3
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          1
         
        
        
         +
        
        
         s
        
        
         [
        
        
         4
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[1:4]) = ( s[1]*B^{3} + s[2]*B^{2} + s[3]*B^{1} + s[4]*B^{0}) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">4</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">4</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         5
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          4
         
        
        
         +
        
        
         s
        
        
         [
        
        
         2
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          3
         
        
        
         +
        
        
         s
        
        
         [
        
        
         3
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          2
         
        
        
         +
        
        
         s
        
        
         [
        
        
         4
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          1
         
        
        
         +
        
        
         s
        
        
         [
        
        
         5
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[1:5]) = ( s[1]*B^{4} + s[2]*B^{3} + s[3]*B^{2} + s[4]*B^{1} + s[5]*B^{0}) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">4</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">5</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></li><li>那么我们如何求 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         3
        
        
         :
        
        
         5
        
        
         ]
        
        
         )
        
       
       
        hash(s[3:5])
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span> 呢？</li><li>直接对字符串遍历，得到的结果为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         3
        
        
         :
        
        
         5
        
        
         ]
        
        
         )
        
        
         =
        
        
         (
        
        
         s
        
        
         [
        
        
         3
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          2
         
        
        
         +
        
        
         s
        
        
         [
        
        
         4
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          1
         
        
        
         +
        
        
         s
        
        
         [
        
        
         5
        
        
         ]
        
        
         ∗
        
        
         
          B
         
         
          0
         
        
        
         )
        
        
        
        
         
          m
         
         
          o
         
         
          d
         
          
        
         P
        
       
       
        hash(s[3:5]) = ( s[3]*B^{2} + s[4]*B^{1} + s[5]*B^{0}) \mod P
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">4</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">5</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 0.666667em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span>，那么通过如下减法，得到：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          
           
            
             
              h
             
             
              a
             
             
              s
             
             
              h
             
             
              (
             
             
              s
             
             
              [
             
             
              1
             
             
              :
             
             
              5
             
             
              ]
             
             
              )
             
             
              −
             
             
              h
             
             
              a
             
             
              s
             
             
              h
             
             
              (
             
             
              s
             
             
              [
             
             
              3
             
             
              :
             
             
              5
             
             
              ]
             
             
              )
             
            
           
          
          
           
            
             
             
              =
             
             
              (
             
             
              s
             
             
              [
             
             
              1
             
             
              ]
             
             
              ∗
             
             
              
               B
              
              
               4
              
             
             
              +
             
             
              s
             
             
              [
             
             
              2
             
             
              ]
             
             
              ∗
             
             
              
               B
              
              
               3
              
             
             
              )
             
             
             
             
              
               m
              
              
               o
              
              
               d
              
               
             
              P
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
             
              =
             
             
              
               B
              
              
               3
              
             
             
              ∗
             
             
              (
             
             
              s
             
             
              [
             
             
              1
             
             
              ]
             
             
              ∗
             
             
              
               B
              
              
               1
              
             
             
              +
             
             
              s
             
             
              [
             
             
              2
             
             
              ]
             
             
              ∗
             
             
              
               B
              
              
               0
              
             
             
              )
             
             
             
             
              
               m
              
              
               o
              
              
               d
              
               
             
              P
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
             
              =
             
             
              
               B
              
              
               3
              
             
             
              ∗
             
             
              h
             
             
              a
             
             
              s
             
             
              h
             
             
              (
             
             
              s
             
             
              [
             
             
              1
             
             
              :
             
             
              2
             
             
              ]
             
             
              )
             
             
             
             
              
               m
              
              
               o
              
              
               d
              
               
             
              P
             
            
           
          
         
        
        
         <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>:</mo><mn>5</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>3</mn><mo>:</mo><mn>5</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><msup><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>4</mn></mrow></msup><mo>+</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><msup><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>P</mi></mtd></mtr><mtr><mtd /><mtd><mi></mi><mo>=</mo><msup><mi>B</mi><mn>3</mn></msup><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><msup><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msup><mo>+</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><msup><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>P</mi></mtd></mtr><mtr><mtd /><mtd><mi></mi><mo>=</mo><msup><mi>B</mi><mn>3</mn></msup><mo>&amp;#x2217;</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>P</mi></mtd></mtr></mtable></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 100%; display: inline-block; min-width: 30.326em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.584em, 1029.72em, 6.938em, -999.997em); top: -5.009em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.584em, 1029.72em, 6.938em, -999.997em); top: -5.009em; left: 50%; margin-left: -14.83em;"><span class="mtable" id="MathJax-Span-3" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 29.566em; height: 0px;"><span style="position: absolute; clip: rect(2.331em, 1012.56em, 6.28em, -999.997em); top: -4.604em; left: 0em;"><span style="display: inline-block; position: relative; width: 12.658em; height: 0px;"><span style="position: absolute; width: 100%; clip: rect(3.091em, 1012.56em, 4.407em, -999.997em); top: -5.363em; left: 0em;"><span class="mtd" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.091em, 1012.56em, 4.407em, -999.997em); top: -3.997em; left: 50%; margin-left: -6.325em;"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main; padding-left: 0.256em;">:</span><span class="mn" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.256em;">5</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.205em;">−</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic; padding-left: 0.205em;">h</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.256em;">:</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.256em;">5</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.85em, 1000em, 4.154em, -999.997em); top: -3.946em; right: 0em;"><span class="mtd" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.85em, 1000em, 4.154em, -999.997em); top: -2.478em; right: 0em;"><span class="mtd" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.609em;"></span></span><span style="position: absolute; clip: rect(2.584em, 1016.86em, 6.938em, -999.997em); top: -5.009em; left: 12.658em;"><span style="display: inline-block; position: relative; width: 16.86em; height: 0px;"><span style="position: absolute; width: 100%; clip: rect(2.939em, 1014.78em, 4.407em, -999.997em); top: -5.363em; left: 0em;"><span class="mtd" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.939em, 1014.78em, 4.407em, -999.997em); top: -3.997em; left: 50%; margin-left: -7.388em;"><span class="mi" id="MathJax-Span-33"></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.256em;">=</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.256em;">(</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="msubsup" id="MathJax-Span-41" style="padding-left: 0.205em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0.357em; height: 0px;"><span style="position: absolute; clip: rect(3.394em, 1000.36em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mn" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.205em;">+</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic; padding-left: 0.205em;">s</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="msubsup" id="MathJax-Span-52" style="padding-left: 0.205em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="texatom" id="MathJax-Span-54"><span class="mrow" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.357em; height: 0px;"><span style="position: absolute; clip: rect(3.394em, 1000.31em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mn" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-58"><span class="mspace" id="MathJax-Span-59" style="height: 0em; vertical-align: 0em; width: 1.015em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.154em;">mod</span><span class="mspace" id="MathJax-Span-61" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-62" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; width: 100%; clip: rect(2.989em, 1016.86em, 4.407em, -999.997em); top: -3.946em; left: 0em;"><span class="mtd" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.989em, 1016.86em, 4.407em, -999.997em); top: -3.997em; left: 50%; margin-left: -8.451em;"><span class="mi" id="MathJax-Span-68"></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.256em;">=</span><span class="msubsup" id="MathJax-Span-70" style="padding-left: 0.256em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="mn" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.205em;">(</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-77" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="msubsup" id="MathJax-Span-80" style="padding-left: 0.205em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 0.357em; height: 0px;"><span style="position: absolute; clip: rect(3.394em, 1000.31em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.205em;">+</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic; padding-left: 0.205em;">s</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-88" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="msubsup" id="MathJax-Span-91" style="padding-left: 0.205em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="texatom" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.357em; height: 0px;"><span style="position: absolute; clip: rect(3.394em, 1000.31em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mn" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-97"><span class="mspace" id="MathJax-Span-98" style="height: 0em; vertical-align: 0em; width: 1.015em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.154em;">mod</span><span class="mspace" id="MathJax-Span-100" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-101" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; width: 100%; clip: rect(2.989em, 1013.42em, 4.407em, -999.997em); top: -2.478em; left: 0em;"><span class="mtd" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.989em, 1013.42em, 4.407em, -999.997em); top: -3.997em; left: 50%; margin-left: -6.68em;"><span class="mi" id="MathJax-Span-107"></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.256em;">=</span><span class="msubsup" id="MathJax-Span-109" style="padding-left: 0.256em;"><span style="display: inline-block; position: relative; width: 1.167em; height: 0px;"><span style="position: absolute; clip: rect(3.192em, 1000.76em, 4.154em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.762em;"><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.205em;">∗</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic; padding-left: 0.205em;">h</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-120" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.256em;">:</span><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.256em;">2</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-125"><span class="mspace" id="MathJax-Span-126" style="height: 0em; vertical-align: 0em; width: 1.015em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.154em;">mod</span><span class="mspace" id="MathJax-Span-128" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-129" style="height: 0em; vertical-align: 0em; width: 0.154em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.014em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.856em; border-left: 0px solid; width: 0px; height: 4.185em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">[</mo><mn>1</mn><mo>:</mo><mn>5</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>−</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">[</mo><mn>3</mn><mo>:</mo><mn>5</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∗</mo><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mn>4</mn></mrow></msup><mo>+</mo><mi>s</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>∗</mo><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msup><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mi>P</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msup><mi>B</mi><mn>3</mn></msup><mo>∗</mo><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∗</mo><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msup><mo>+</mo><mi>s</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>∗</mo><msup><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msup><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mi>P</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><msup><mi>B</mi><mn>3</mn></msup><mo>∗</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mi>P</mi></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{aligned}hash(s[1:5]) - hash(s[3:5]) &= ( s[1]*B^{4} + s[2]*B^{3} ) \mod P \\ &= B^3 * ( s[1]*B^{1} + s[2]*B^{0} ) \mod P \\ &= B^3 * hash(s[1:2]) \mod P \end{aligned}</script>
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 4.57232em; vertical-align: -2.03616em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.53616em;"><span class="" style="top: -4.67205em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span></span></span><span class="" style="top: -3.14795em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -1.62384em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.03616em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.53616em;"><span class="" style="top: -4.67205em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span><span class="" style="top: -3.14795em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span><span class="" style="top: -1.62384em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.03616em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></li><li>移项后整理式子，得到：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          [
         
         
          3
         
         
          :
         
         
          5
         
         
          ]
         
         
          )
         
         
          =
         
         
          (
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          [
         
         
          1
         
         
          :
         
         
          5
         
         
          ]
         
         
          )
         
         
          −
         
         
          
           B
          
          
           3
          
         
         
          ∗
         
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          [
         
         
          1
         
         
          :
         
         
          2
         
         
          ]
         
         
          )
         
         
          )
         
         
         
         
          
           m
          
          
           o
          
          
           d
          
           
         
          P
         
        
        
         hash(s[3:5]) = ( hash(s[1:5]) - B^3 * hash(s[1:2]) ) \mod P
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 1em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></span></li><li>那么对于更加一般的情况，令 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         (
        
        
         r
        
        
         )
        
        
         =
        
        
         h
        
        
         a
        
        
         s
        
        
         h
        
        
         (
        
        
         s
        
        
         [
        
        
         1
        
        
         :
        
        
         r
        
        
         ]
        
        
         )
        
       
       
        h(r) = hash(s[1:r])
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span>，有：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          h
         
         
          a
         
         
          s
         
         
          h
         
         
          (
         
         
          s
         
         
          [
         
         
          l
         
         
          :
         
         
          r
         
         
          ]
         
         
          )
         
         
          =
         
         
          (
         
         
          h
         
         
          (
         
         
          r
         
         
          )
         
         
          −
         
         
          
           B
          
          
           
            r
           
           
            −
           
           
            l
           
           
            +
           
           
            1
           
          
         
         
          ∗
         
         
          h
         
         
          (
         
         
          l
         
         
          −
         
         
          1
         
         
          )
         
         
          )
         
         
         
         
          
           m
          
          
           o
          
          
           d
          
           
         
          P
         
        
        
         hash(s[l:r]) = ( h(r) - B^{r-l+1} * h(l-1) ) \mod P
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.899108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right: 1em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span></span></span></span></span></span></li><li>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         h
        
        
         (
        
        
         i
        
        
         )
        
       
       
        h(i)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          B
         
         
          i
         
        
       
       
        B^i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> 都可以事先一次线性扫描预处理后放在数组中，则每次取子串哈希值的时间复杂度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         1
        
        
         )
        
       
       
        O(1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>。</li></ul> 
<h1><a name="t23"></a><a id="_231"></a>三、哈希表的应用</h1> 
<h2><a name="t24"></a><a id="1_232"></a>1、代替排序</h2> 
<blockquote> 
 <p>【例题1】给定 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         (
        
        
         n
        
        
         &lt;
        
        
         1
        
        
         
          0
         
         
          6
         
        
        
         )
        
       
       
        n(n &lt;10^6)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         −
        
        
         1
        
        
         
          0
         
         
          6
         
        
        
         ,
        
        
         1
        
        
         
          0
         
         
          6
         
        
        
         ]
        
       
       
        [-10^6,10^6]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span> 范围内的整数 ，请按从大到小的顺序输出其中前 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         m
        
       
       
        m
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> 大的数。</p> 
</blockquote> 
<ul><li>这是一个经典排序问题。时间复杂度 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         n
        
        
         l
        
        
         o
        
        
         g
        
        
         n
        
        
         )
        
       
       
        O(nlogn)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span>，基本也能接受。</li><li>但是，还有一种更加简单的办法，就是开一个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         2
        
        
         ∗
        
        
         1
        
        
         
          0
         
         
          6
         
        
       
       
        2*10^6
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 的哈希数组，然后将所有输入的数字加上一个偏移量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         1
        
        
         
          0
         
         
          6
         
        
       
       
        10^6
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 后，哈希到数组中进行标记，最后来一次全范围的扫描输出即可。</li></ul> 
<h2><a name="t25"></a><a id="2_238"></a>2、多元方程的整数解数</h2> 
<blockquote> 
 <p>【例题2】给定一个方程 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         a
        
        
         +
        
        
         y
        
        
         b
        
        
         +
        
        
         z
        
        
         c
        
        
         =
        
        
         d
        
       
       
        xa + yb + zc = d
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         a
        
        
         ,
        
        
         b
        
        
         ,
        
        
         c
        
        
         ,
        
        
         d
        
       
       
        a,b,c,d
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span></span></span></span></span> 已知，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         0
        
        
         ≤
        
        
         x
        
        
         ,
        
        
         y
        
        
         ,
        
        
         z
        
        
         ≤
        
        
         1000
        
        
         )
        
       
       
        (0 \le x,y,z \le 1000)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83041em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>，求满足条件的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         ,
        
        
         y
        
        
         ,
        
        
         z
        
       
       
        x,y,z
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span> 的解数。</p> 
</blockquote> 
<ul><li>这是一个可以利用哈希表来求解的经典问题，朴素的做法就是三层循环枚举所有满足条件的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         ，
        
        
         y
        
        
         ，
        
        
         z
        
       
       
        x，y，z
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>，然后判断计算结果是否为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         d
        
       
       
        d
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>，这样的时间复杂度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         
          n
         
         
          3
         
        
        
         )
        
       
       
        O(n^3)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，肯定是无法接受的。</li><li>可以将等式进行移项，变成如下形式：</li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          x
         
         
          a
         
         
          +
         
         
          y
         
         
          b
         
         
          =
         
         
          d
         
         
          −
         
         
          z
         
         
          c
         
        
        
         xa + yb = d - zc
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mord mathdefault">c</span></span></span></span></span></span></li><li>我们可以通过枚举 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         z
        
       
       
        z
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span></span>，将所有计算得到的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         d
        
        
         −
        
        
         z
        
        
         c
        
       
       
        d - zc
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mord mathdefault">c</span></span></span></span></span> 的值映射到哈希表中，记录下每个结果出现的次数，然后两层循环枚举 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         x
        
        
         ,
        
        
         y
        
        
         )
        
       
       
        (x, y)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> ，看枚举计算得到的值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         x
        
        
         a
        
        
         +
        
        
         y
        
        
         b
        
       
       
        xa + yb
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord mathdefault">b</span></span></span></span></span> 在哈希表出现的次数，累加所有的这些和就是最后的答案了，整个算法的时间复杂度即枚举的时间复杂度，为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         
          n
         
         
          2
         
        
        
         )
        
       
       
        O(n^2)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</li><li>再来看一个简单的变种。</li></ul> 
<blockquote> 
 <p>【例题3】给定 5 个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         (
        
        
         n
        
        
         ≤
        
        
         200
        
        
         )
        
       
       
        n(n \le 200)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> 个整数的集合 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         a
        
        
         [
        
        
         i
        
        
         ]
        
        
         [
        
        
         j
        
        
         ]
        
        
         (
        
        
         0
        
        
         ≤
        
        
         i
        
        
         &lt;
        
        
         5
        
        
         ,
        
        
         0
        
        
         ≤
        
        
         j
        
        
         &lt;
        
        
         n
        
        
         )
        
       
       
        a[i][j](0 \le i&lt;5, 0 \le j&lt;n)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69862em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span> ，问是否存在一个下标五元组<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         ,
        
        
         k
        
        
         ,
        
        
         l
        
        
         ,
        
        
         m
        
        
         )
        
       
       
        (i,j,k,l,m)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></span>，满足如下等式： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          a
         
         
          [
         
         
          0
         
         
          ]
         
         
          [
         
         
          i
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          1
         
         
          ]
         
         
          [
         
         
          j
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          2
         
         
          ]
         
         
          [
         
         
          k
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          3
         
         
          ]
         
         
          [
         
         
          l
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          4
         
         
          ]
         
         
          [
         
         
          m
         
         
          ]
         
         
          =
         
         
          0
         
        
        
         a[0][i] + a[1][j] + a[2][k] + a[3][l] + a[4][m] = 0
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">4</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></span></p> 
</blockquote> 
<ul><li>朴素的做法就是枚举这个五元组 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         ,
        
        
         k
        
        
         ,
        
        
         l
        
        
         ,
        
        
         m
        
        
         )
        
       
       
        (i,j,k,l,m)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></span>，对数组中的五个数加和后进行判零，但是这样做的时间复杂度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         
          n
         
         
          5
         
        
        
         )
        
       
       
        O(n^5)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</li><li>考虑将等式做一个变换如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          a
         
         
          [
         
         
          0
         
         
          ]
         
         
          [
         
         
          i
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          1
         
         
          ]
         
         
          [
         
         
          j
         
         
          ]
         
         
          =
         
         
          −
         
         
          (
         
         
          a
         
         
          [
         
         
          2
         
         
          ]
         
         
          [
         
         
          k
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          3
         
         
          ]
         
         
          [
         
         
          l
         
         
          ]
         
         
          +
         
         
          a
         
         
          [
         
         
          4
         
         
          ]
         
         
          [
         
         
          m
         
         
          ]
         
         
          )
         
        
        
         a[0][i] + a[1][j] = - ( a[2][k] + a[3][l] + a[4][m] )
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">4</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></span></li><li>那么我们如果把前两个数组的数字加和都枚举出来，然后加到哈希表中，然后就可以通过枚举后面三个数组的加和，取相反数以后去哈希表里面找，如果找到一个就算满足条件了，时间复杂度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         
          n
         
         
          3
         
        
        
         )
        
       
       
        O(n^3)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</li></ul> 
<h2><a name="t26"></a><a id="3_250"></a>3、状态哈希</h2> 
<ul><li>状态哈希 在 动态规划 和 广度优先搜索 中有着广泛的应用，不理解也没有关系，来日方长，这一章先简要介绍一下，毕竟我当年理解状态的概念，也花了很久的时间。</li></ul> 
<h3><a name="t27"></a><a id="1_253"></a>1）动态规划的状态哈希</h3> 
<ul><li>之前在讲动态规划的时候，强调了状态的概念，那么这一章我们再强化一下。</li></ul> 
<blockquote> 
 <p>【例题5】一个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         ×
        
        
         m
        
        
         (
        
        
         n
        
        
         ×
        
        
         m
        
        
         ≤
        
        
         1
        
        
         
          0
         
         
          6
         
        
        
         )
        
       
       
        n \times m(n \times m \le 10^6)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77194em; vertical-align: -0.13597em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的棋盘，作者从左上角出发，只能往右或者往下，每个格子颜色不同，不同颜色对应不同分数，求到达右下角的最大分数。<br> <img src="https://img-blog.csdnimg.cn/20210120183328703.png#pic_center" alt=""></p>
 <center>
  图三-3-1
  <center></center>
 </center>
 <p></p> 
</blockquote> 
<ul><li>这个问题是最简单的 二维DP 了，基本上一眼就能看出状态转移方程：</li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          d
         
         
          p
         
         
          [
         
         
          i
         
         
          ]
         
         
          [
         
         
          j
         
         
          ]
         
         
          =
         
         
          v
         
         
          a
         
         
          l
         
         
          (
         
         
          i
         
         
          ,
         
         
          j
         
         
          )
         
         
          +
         
         
          m
         
         
          a
         
         
          x
         
         
          (
         
         
          d
         
         
          p
         
         
          [
         
         
          i
         
         
          −
         
         
          1
         
         
          ]
         
         
          [
         
         
          j
         
         
          ]
         
         
          ,
         
         
          d
         
         
          p
         
         
          [
         
         
          i
         
         
          ]
         
         
          [
         
         
          j
         
         
          −
         
         
          1
         
         
          ]
         
         
          )
         
        
        
         dp[i][j] = val(i,j) + max(dp[i-1][j], dp[i][j-1])
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         d
        
        
         p
        
        
         [
        
        
         i
        
        
         ]
        
        
         [
        
        
         j
        
        
         ]
        
       
       
        dp[i][j]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span> 代表从左上角 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         1
        
        
         ,
        
        
         1
        
        
         )
        
       
       
        (1,1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 走到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         )
        
       
       
        (i, j)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 的最大分数， <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         )
        
       
       
        (i, j)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 代表位置也代表状态。</li><li>但是，由于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
       
       
        n
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         m
        
       
       
        m
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> 的最大乘积为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         1
        
        
         
          0
         
         
          6
         
        
       
       
        10^6
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>，所以极端情况下：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         =
        
        
         1
        
        
         
          0
         
         
          6
         
        
        
         ，
        
        
         m
        
        
         =
        
        
         1
        
       
       
        n=10^6，m=1
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 或者 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         =
        
        
         1
        
        
         ，
        
        
         m
        
        
         =
        
        
         1
        
        
         
          0
         
         
          6
         
        
       
       
        n=1，m=10^6
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 的情况都是有可能出现的，这样就不能用二维数组了，那么我们能不能拿 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         j
        
       
       
        j
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span></span></span></span></span> 的乘积作为状态表示呢？</li><li>答案是不能！</li><li>因为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         )
        
       
       
        (i, j)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         j
        
        
         ,
        
        
         i
        
        
         )
        
       
       
        (j, i)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span> 不是同一个状态。</li><li>于是，我们结合今天学习的知识，联想到了可以将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         j
        
       
       
        j
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span></span></span></span></span> 作为一个二元组，映射到一个长整型，即：</li><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
      
       
        
         
          (
         
         
          i
         
         
          ,
         
         
          j
         
         
          )
         
         
          →
         
         
          (
         
         
          i
         
         
          ∗
         
         
          1
         
         
          
           0
          
          
           9
          
         
         
          +
         
         
          j
         
         
          )
         
        
        
         (i, j) \to (i * 10^9 + j)
        
       
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.947438em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></span></li><li>然后就可以用散列哈希进行状态存储了。</li></ul> 
<h3><a name="t28"></a><a id="2_266"></a>2）广度优先搜索的状态哈希</h3> 
<ul><li>广度优先搜索往往用来求解一些最短路问题，比如 迷宫问题、数码问题、推箱子游戏 等等，要求用最少的步数，到达某个位置或者完成某个目标，这里举一个最简单的例子。</li></ul> 
<blockquote> 
 <p>【例题6】一个<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         n
        
        
         ×
        
        
         m
        
        
         (
        
        
         n
        
        
         ,
        
        
         m
        
        
         &lt;
        
        
         =
        
        
         100
        
        
         )
        
       
       
        n \times m(n,m &lt;=100)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> 的迷宫，绿色的格子代表可以走，红色的格子是岩浆不能走，地图上有两个人他们以相同的方式往四个方向 上、下、左、右 走，每走一格需要一刻时间，问两人相遇的最短时间为多少。<br> <img src="https://img-blog.csdnimg.cn/20210120185231919.png#pic_center" alt=""></p>
 <center>
  图三-3-2
  <center></center>
 </center>
 <p></p> 
</blockquote> 
<ul><li>这是个经典的广度优先搜索问题，如果用深度优先搜索来做，状态空间太大，时间复杂度是指数级的。而广搜的时间复杂度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         n
        
        
         m
        
        
         )
        
       
       
        O(nm)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></span>，之所以能够把时间复杂度控制在多项式级别，是因为走过的位置会被标记掉。</li><li>这个问题只要考虑一个人从起点走到终点就行，对最后的时间进行除二处理，考虑下奇偶性。</li><li>每个位置 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         )
        
       
       
        (i,j)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 就代表了状态，用 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         t
        
        
         i
        
        
         m
        
        
         e
        
        
         [
        
        
         i
        
        
         ]
        
        
         [
        
        
         j
        
        
         ]
        
       
       
        time[i][j]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span> 代表从 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         1
        
        
         ,
        
        
         1
        
        
         )
        
       
       
        (1,1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         (
        
        
         i
        
        
         ,
        
        
         j
        
        
         )
        
       
       
        (i,j)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 花费的最短时间，初始化为最大值，利用队列扩展状态，每走到一个点判断当前的时间是否比 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         t
        
        
         i
        
        
         m
        
        
         e
        
        
         [
        
        
         i
        
        
         ]
        
        
         [
        
        
         j
        
        
         ]
        
       
       
        time[i][j]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span> 小，如果大于等于的话就没必要入队了，直到队列为空或者到达目的地则搜索完毕。</li><li>这个问题就告一段落了。</li><li>但是，并不是所有问题中，位置代表状态，来看一个经典的游戏 —— 推箱子。<br> <img src="https://img-blog.csdnimg.cn/20210120182149278.gif#pic_center" alt="">
  <center>
   图三-3-3
   <center></center>
  </center></li><li>这个问题中，推箱子的人两次访问同一个位置时，整个地图的状态是不一样的，因为箱子的位置变了。</li><li>没错！在这个问题中，状态要用 人 和 所有箱子 的位置（6个坐标）来表示。限于篇幅，就不再展开了。这个问题会在讲解广度优先搜索的时候再进行详细讲解。</li></ul> 
<h2><a name="t29"></a><a id="4_280"></a>4、最长回文串</h2> 
<blockquote> 
 <p>【例题7】给定一个字符串，最多 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         1
        
        
         
          0
         
         
          6
         
        
       
       
        10^6
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span> 个字符，求最长回文子串的长度。例如字符串 “abacdcbaaaab”，最长回文子串的长度为 “baaaab”，所以答案为 6 。</p> 
</blockquote> 
<ul><li>思路就是枚举一个中心，然后二分长度，对于二分到的长度用字符串哈希在 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         O
        
        
         (
        
        
         1
        
        
         )
        
       
       
        O(1)
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> 的时间判断两边的字符串是否相等。由于字符串哈希是单向的，而回文串的方向是往相反方向扩散，所以需要将字符串预处理哈希后，逆序再预处理一次哈希。</li><li>对于字符串从下标 1 开始，罗列如下：</li></ul> 
<div class="table-box"><table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody><tr><td>a</td><td>b</td><td>a</td><td>c</td><td>d</td><td>c</td><td>b</td><td>a</td><td>a</td><td>a</td><td>a</td><td>b</td></tr></tbody></table></div>
<ul><li>将字符串进行逆序后得到：</li></ul> 
<div class="table-box"><table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody><tr><td>b</td><td>a</td><td>a</td><td>a</td><td>a</td><td>b</td><td>c</td><td>d</td><td>c</td><td>a</td><td>b</td><td>a</td></tr></tbody></table></div>
<ul><li>回文子串的长度有可能是奇数，也有可能是偶数，所以需要分情况讨论：</li><li>对于奇数的情况，如果枚举的中心下标为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>，则能够扩散的长度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         l
        
        
         ∈
        
        
         [
        
        
         1
        
        
         ,
        
        
         m
        
        
         i
        
        
         n
        
        
         (
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         +
        
        
         1
        
        
         ,
        
        
         i
        
        
         )
        
        
         ]
        
       
       
        l \in [1, min(len - i +1, i)]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.74285em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span> ，二分这个长度，然后判断原字符串的子串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         i
        
        
         −
        
        
         l
        
        
         +
        
        
         1
        
        
         ,
        
        
         i
        
        
         ]
        
       
       
        [i-l+1, i]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> 和 逆序字符串的子串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         −
        
        
         l
        
        
         +
        
        
         2
        
        
         ,
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         +
        
        
         1
        
        
         ]
        
       
       
        [len-i-l+2, len-i+1]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.74285em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.74285em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> 是否相等，相等则扩大二分区间；否则，减少；</li></ul> 
<p><img src="https://img-blog.csdnimg.cn/img_convert/bdaebb3c5115186d989427556b4d5802.png#pic_center" alt=""></p>
<center>
 图三-4-1
 <center></center>
</center>
<p></p> 
<ul><li>对于偶数的情况，如果枚举的中心下标为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         i
        
       
       
        i
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>，则能够扩散的长度为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         l
        
        
         ∈
        
        
         [
        
        
         0
        
        
         ,
        
        
         m
        
        
         i
        
        
         n
        
        
         (
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         ,
        
        
         i
        
        
         )
        
        
         ]
        
       
       
        l \in [0, min(len - i, i)]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span> ，二分这个长度，然后判断原字符串的子串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         i
        
        
         −
        
        
         l
        
        
         +
        
        
         1
        
        
         ,
        
        
         i
        
        
         ]
        
       
       
        [i-l+1, i]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> 和 逆序字符串的子串 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         [
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         −
        
        
         l
        
        
         +
        
        
         1
        
        
         ,
        
        
         l
        
        
         e
        
        
         n
        
        
         −
        
        
         i
        
        
         ]
        
       
       
        [len-i-l+1, len-i]
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.74285em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span> 是否相等，相等则扩大二分区间；否则，减少；<br> <img src="https://img-blog.csdnimg.cn/img_convert/fe7ef81ee0d7e5c85fd4c565a06812ab.png#pic_center" alt="">
  <center>
   图三-4-2
   <center></center>
  </center></li></ul> 
<h2><a name="t30"></a><a id="5_300"></a>5、最长公共子串</h2> 
<blockquote> 
 <p>【例题8】给定两个长度不超过 400000 的字符串，求两个串的最长公共子串的长度。</p> 
</blockquote> 
<ul><li>二分一个长度 L，在第一个串上作给定长度 L 的所有子串的字符串哈希，并且散列到哈希数组中，然后在第二个子串上进行枚举长度为 L 的子串，看哈希数组中是否存在，一旦存在，说明最长公共子串的长度至少为 L，二分的答案扩大；否则，答案缩小；</li></ul> 
<hr> 
<ul><li>关于 <font color="red"><b>哈希表</b></font> 的内容到这里就结束了。</li><li>如果还有不懂的问题，可以 <font color="red"><b>想方设法</b></font> 找到作者的微信进行在线咨询。</li></ul> 
<hr> 
<ul><li>本文所有示例代码均可在以下 github 上找到：<a href="https://github.com/WhereIsHeroFrom/Code_Templates/tree/master/HASH">github.com/WhereIsHeroFrom/模板/HASH</a></li></ul> 
<hr> 
<p><img src="https://img-blog.csdnimg.cn/20210105190605774.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1doZXJlSXNIZXJvRnJvbQ==,size_16,color_FFFFFF,t_70" alt=""></p> 
<hr> 
<h1><a name="t31"></a><a id="_314"></a>四、哈希题集整理</h1> 
<div class="table-box"><table><thead><tr><th>题目链接</th><th>难度</th><th>解法</th></tr></thead><tbody><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1264">HDU 1264 Counting Squares</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1425">HDU 1425 sort</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2523">HDU 2523 SORT AGAIN</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2217">HDU 2217 Visit</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2220">HDU 2220 Encode the tree</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2240">HDU 2240 考研路茫茫——人到大四 </a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2265">HDU 2265 Encoding The Diary</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2270">HDU 2270 How Many Friends Will Be Together With You</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2341">HDU 2341 Tower Parking</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2369">HDU 2369 Broken Keyboard</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2946">HDU 2946 Letter Cookies</a></td><td>★☆☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3107">HDU 3107 A Walk in the Park </a></td><td>★★☆☆☆</td><td>简单坐标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1496">HDU 1496 Equations</a></td><td>★★☆☆☆</td><td>等式的整数散列哈希</td></tr><tr><td><a href="http://poj.org/problem?id=1186">PKU 1186 方程的解数</a></td><td>★★☆☆☆</td><td>等式的整数散列哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1880">HDU 1880 魔咒词典</a></td><td>★★☆☆☆</td><td>字符串哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2428">HDU 2428 Stars</a></td><td>★★☆☆☆</td><td>简单下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4908">HDU 4908 BestCoder Sequence</a></td><td>★★☆☆☆</td><td>统计类下标哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4334">HDU 4334 Trouble</a></td><td>★★☆☆☆</td><td>等式的整数散列哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5269">HDU 5269 ZYB loves Xor I</a></td><td>★★☆☆☆</td><td>位运算 + 统计散列哈希</td></tr><tr><td><a href="https://www.luogu.com.cn/problem/P3370">P3370 【模板】字符串哈希</a></td><td>★★☆☆☆</td><td>字符串哈希模板</td></tr><tr><td><a href="http://poj.org/problem?id=3349">PKU 3349 Snowflake Snow Snowflakes</a></td><td>★★☆☆☆</td><td>字符串哈希模板</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3763">HDU 3763 CD</a></td><td>★★☆☆☆</td><td>散列哈希模板题</td></tr><tr><td><a href="http://poj.org/problem?id=3974">PKU 3974 Palindrome</a></td><td>★★★☆☆</td><td>二分答案 + 字符串哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4080">HDU 4080 Stammering Aliens</a></td><td>★★★☆☆</td><td>二分答案 + 字符串哈希</td></tr><tr><td><a href="http://poj.org/problem?id=2758">PKU 2758 Checking the Text</a></td><td>★★★☆☆</td><td>二分答案 + 字符串哈希</td></tr><tr><td><a href="http://poj.org/problem?id=2774">PKU 2774 Long Long Message</a></td><td>★★★☆☆</td><td>二分答案 + 字符串哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4961">HDU 4961 Boring Sum</a></td><td>★★★☆☆</td><td>枚举因子 + 哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5701">HDU 5701 中位数计数</a></td><td>★★★☆☆</td><td>离散化 + 哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5416">HDU 5416 CRB and Tree</a></td><td>★★★☆☆</td><td>位运算 + 哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5908">HDU 5908 Abelian Period</a></td><td>★★★☆☆</td><td>枚举 + 哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2969">HDU 2969 Skyscrapers</a></td><td>★★★☆☆</td><td>贪心 + 哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6768">HDU 6768 The Oculus</a></td><td>★★★☆☆</td><td>字符串哈希 + 枚举可行位</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5183">HDU 5183 Negative and Positive (NP)</a></td><td>★★★★☆</td><td>较为复杂的等式整数哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5469">HDU 5469 Antonidas</a></td><td>★★★★☆</td><td>树的分治 + 字符串哈希</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4622">HDU 4622 Reincarnation</a></td><td>★★★★★</td><td>字符串哈希 或 后缀自动机</td></tr><tr><td><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6646">HDU 6646 A + B = C</a></td><td>★★★★★</td><td>字符串哈希</td></tr><tr><td><a href="http://poj.org/problem?id=3274">PKU 3274 Gold Balanced Lineup</a></td><td>★★★★★</td><td>散列哈希</td></tr></tbody></table></div>
                </div><div data-report-view="{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://blog.csdn.net/WhereIsHeroFrom/article/details/112756337&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}"><div></div></div>
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-3fd7f7a902.css" rel="stylesheet">
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-49037e4d27.css" rel="stylesheet">
        </div>